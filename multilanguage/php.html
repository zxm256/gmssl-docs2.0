<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GmSSL-PHP | GmSSL-Docs</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="GmSSL说明文档">
    
    <link rel="preload" href="/gmssl-docs2.0/assets/css/0.styles.3dd227a3.css" as="style"><link rel="preload" href="/gmssl-docs2.0/assets/js/app.1d85ac51.js" as="script"><link rel="preload" href="/gmssl-docs2.0/assets/js/2.a98f6d9f.js" as="script"><link rel="preload" href="/gmssl-docs2.0/assets/js/1.43cfabac.js" as="script"><link rel="preload" href="/gmssl-docs2.0/assets/js/36.d1e4ac7a.js" as="script"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/10.18312648.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/11.89ac9f07.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/12.da302e69.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/13.9d2d66b6.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/14.cb88526c.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/15.980f0cec.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/16.f4bf23f4.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/17.3ceb826c.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/18.b434740f.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/19.b0466d00.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/20.404aed17.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/21.491ae04b.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/22.096b5219.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/23.87bde842.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/24.7fcad792.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/25.fa10b3ea.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/26.a3fc9dd7.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/27.0c16171d.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/28.ad52af29.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/29.dbafc828.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/3.e04a1178.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/30.555d9848.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/31.ef8c3c31.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/32.e310fc10.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/33.5b344843.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/34.78ca91f6.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/35.0a98fd25.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/37.21aaedca.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/4.6aaf9938.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/5.868c619a.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/6.11ff47cc.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/7.3acf3203.js"><link rel="prefetch" href="/gmssl-docs2.0/assets/js/vendors~docsearch.5a4296f1.js">
    <link rel="stylesheet" href="/gmssl-docs2.0/assets/css/0.styles.3dd227a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/gmssl-docs2.0/" class="home-link router-link-active"><!----> <span class="site-name">GmSSL-Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/gmssl-docs2.0/guide/" class="nav-link">
  使用指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="多语言支持" class="dropdown-title"><span class="title">多语言支持</span> <span class="arrow down"></span></button> <button type="button" aria-label="多语言支持" class="mobile-dropdown-title"><span class="title">多语言支持</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/gmssl-docs2.0/multilanguage/java.html" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/gmssl-docs2.0/multilanguage/python.html" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/gmssl-docs2.0/multilanguage/php.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  PHP
</a></li><li class="dropdown-item"><!----> <a href="/gmssl-docs2.0/multilanguage/go.html" class="nav-link">
  Go
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="国密算法接口" class="dropdown-title"><span class="title">国密算法接口</span> <span class="arrow down"></span></button> <button type="button" aria-label="国密算法接口" class="mobile-dropdown-title"><span class="title">国密算法接口</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          分组密码
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/gmssl-docs2.0/crypto/block/sm4.html" class="nav-link">
  SM4
</a></li></ul></li><li class="dropdown-item"><h4>
          公钥密码
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/gmssl-docs2.0/crypto/public/sm2.html" class="nav-link">
  SM2
</a></li></ul></li><li class="dropdown-item"><h4>
          流密码
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/gmssl-docs2.0/crypto/stream/zuc.html" class="nav-link">
  ZUC
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/guanzhi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/gmssl-docs2.0/guide/" class="nav-link">
  使用指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="多语言支持" class="dropdown-title"><span class="title">多语言支持</span> <span class="arrow down"></span></button> <button type="button" aria-label="多语言支持" class="mobile-dropdown-title"><span class="title">多语言支持</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/gmssl-docs2.0/multilanguage/java.html" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/gmssl-docs2.0/multilanguage/python.html" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/gmssl-docs2.0/multilanguage/php.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  PHP
</a></li><li class="dropdown-item"><!----> <a href="/gmssl-docs2.0/multilanguage/go.html" class="nav-link">
  Go
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="国密算法接口" class="dropdown-title"><span class="title">国密算法接口</span> <span class="arrow down"></span></button> <button type="button" aria-label="国密算法接口" class="mobile-dropdown-title"><span class="title">国密算法接口</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          分组密码
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/gmssl-docs2.0/crypto/block/sm4.html" class="nav-link">
  SM4
</a></li></ul></li><li class="dropdown-item"><h4>
          公钥密码
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/gmssl-docs2.0/crypto/public/sm2.html" class="nav-link">
  SM2
</a></li></ul></li><li class="dropdown-item"><h4>
          流密码
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/gmssl-docs2.0/crypto/stream/zuc.html" class="nav-link">
  ZUC
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/guanzhi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/gmssl-docs2.0/guide/" class="sidebar-heading clickable open"><span>多语言支持</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/gmssl-docs2.0/multilanguage/" aria-current="page" class="sidebar-link">多语言支持</a></li><li><a href="/gmssl-docs2.0/multilanguage/java.html" class="sidebar-link">GmSSL-Java</a></li><li><a href="/gmssl-docs2.0/multilanguage/python.html" class="sidebar-link">GmSSL-Python</a></li><li><a href="/gmssl-docs2.0/multilanguage/php.html" aria-current="page" class="active sidebar-link">GmSSL-PHP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/gmssl-docs2.0/multilanguage/php.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/gmssl-docs2.0/multilanguage/php.html#download" class="sidebar-link">Download</a></li><li class="sidebar-sub-header"><a href="/gmssl-docs2.0/multilanguage/php.html#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/gmssl-docs2.0/multilanguage/php.html#quick-start" class="sidebar-link">Quick Start</a></li><li class="sidebar-sub-header"><a href="/gmssl-docs2.0/multilanguage/php.html#gmssl-php-api" class="sidebar-link">GmSSL PHP API</a></li></ul></li><li><a href="/gmssl-docs2.0/multilanguage/go.html" class="sidebar-link">GmSSL-Go</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="gmssl-php"><a href="#gmssl-php" class="header-anchor">#</a> GmSSL-PHP</h1> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>The PHP GmSSL extension is the binding to the GmSSL C library, which provides functions of Chinese SM2, SM3, SM4, SM9, ZUC crypto algorithms.</p> <h2 id="download"><a href="#download" class="header-anchor">#</a> Download</h2> <ul><li>GitHub repo of this project https://github.com/GmSSL/GmSSL-PHP</li> <li>Latest source code <a href="https://github.com/GmSSL/GmSSL-PHP/archive/refs/heads/main.zip" target="_blank" rel="noopener noreferrer">GmSSL-PHP-main.zip<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <p>To compile and install the GmSSL PHP extension, you need to install the GmSSL library (version &gt;= 3.1.0). See the GmSSL INSTALL.md for more details.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token builtin class-name">cd</span> GmSSL-PHP-master
$ phpize
$ ./configure
$ <span class="token function">make</span>
$ <span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span>
</code></pre></div><p>The GmSSL PHP extension need to be enabled in the <code>php.ini</code>.</p> <div class="language- extra-class"><pre class="language-text"><code>$ sudo vim `php-config --ini-path`/php.ini
</code></pre></div><p>Search &quot;Dynamic Extensions&quot; and dd a new line <code>extension=gmssl</code> at the end of this section.</p> <p>You can print the constant value <code>GMSSL_PHP_VERSION</code> to see if the GmSSL extension is correctly installed.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token constant">GMSSL_PHP_VERSION</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code>php gmssl.php
</code></pre></div><h2 id="quick-start"><a href="#quick-start" class="header-anchor">#</a> Quick Start</h2> <p>You can start GmSSL extension with the following simple examples of SM3, SM4 and SM2 crypto algorithms.</p> <h3 id="sm3-examples"><a href="#sm3-examples" class="header-anchor">#</a> SM3 Examples</h3> <p>SM3 is a cryptographic hash function with 256-bit output hash value.
Compute the SM3 digest of the string &quot;abc&quot;.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
	<span class="token variable">$hash</span> <span class="token operator">=</span> <span class="token function">gmssl_sm3</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token variable">$hash</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h3 id="sm4-examples"><a href="#sm4-examples" class="header-anchor">#</a> SM4 Examples</h3> <p>SM4 is a block cipher with 128-bit key length and 128-bit block size.
Use SM4 to encrypt a block of message (16 bytes).</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
	<span class="token variable">$key</span> <span class="token operator">=</span> <span class="token function">gmssl_rand_bytes</span><span class="token punctuation">(</span><span class="token constant">GMSSL_SM4_KEY_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$block</span> <span class="token operator">=</span> <span class="token function">gmssl_rand_bytes</span><span class="token punctuation">(</span><span class="token constant">GMSSL_SM4_BLOCK_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$ciphertext</span> <span class="token operator">=</span> <span class="token function">gmssl_sm4_encrypt</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$block</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$plaintext</span> <span class="token operator">=</span> <span class="token function">gmssl_sm4_decrypt</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$ciphertext</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token variable">$block</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token variable">$plaintext</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p>The <code>gmssl_sm4_encrypt</code> and <code>gmssl_sm4_decrypt</code> functions export low-level API of SM4 block cipher.
For the encryption of typical message, You can use SM4 with some encryption modes, such as CBC, CTR and GCM mode.
The GCM mode is the recommended mode for non-expert users.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
	<span class="token variable">$key</span> <span class="token operator">=</span> <span class="token function">gmssl_rand_bytes</span><span class="token punctuation">(</span><span class="token constant">GMSSL_SM4_KEY_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$iv</span> <span class="token operator">=</span> <span class="token function">gmssl_rand_bytes</span><span class="token punctuation">(</span><span class="token constant">GMSSL_SM4_GCM_DEFAULT_ID_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$aad</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;Encoding: Text&quot;</span><span class="token punctuation">;</span>
	<span class="token variable">$message</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;This is the secret text message.&quot;</span><span class="token punctuation">;</span>

	<span class="token variable">$ciphertext</span> <span class="token operator">=</span> <span class="token function">gmssl_sm4_gcm_encrypt</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$iv</span><span class="token punctuation">,</span> <span class="token variable">$aad</span><span class="token punctuation">,</span> <span class="token variable">$message</span><span class="token punctuation">,</span> <span class="token constant">GMSSL_SM4_GCM_MAX_TAG_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$plaintext</span> <span class="token operator">=</span> <span class="token function">gmssl_sm4_gcm_decrypt</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$iv</span><span class="token punctuation">,</span> <span class="token variable">$aad</span><span class="token punctuation">,</span> <span class="token variable">$ciphertext</span><span class="token punctuation">,</span> <span class="token constant">GMSSL_SM4_GCM_MAX_TAG_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token variable">$message</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token variable">$plaintext</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h3 id="sm2-examples"><a href="#sm2-examples" class="header-anchor">#</a> SM2 Examples</h3> <p>SM2 is the ellptic curve cryptogrphy standard of China. The standard includes the SM2 signature algorithm, the SM2 public key encryption algorithm and the recommended 256-bit SM2 domain parameters.
Here is the example of SM2 key generation, signature generation/verification, and the SM2 public key encryption/decryption.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
	<span class="token variable">$sm2_key</span> <span class="token operator">=</span> <span class="token function">gmssl_sm2_key_generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;123456&quot;</span><span class="token punctuation">;</span>
	<span class="token function">gmssl_sm2_private_key_info_encrypt_to_pem</span><span class="token punctuation">(</span><span class="token variable">$sm2_key</span><span class="token punctuation">,</span> <span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;sm2.pem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">gmssl_sm2_public_key_info_to_pem</span><span class="token punctuation">(</span><span class="token variable">$sm2_key</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;sm2pub.pem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$sm2_pub</span> <span class="token operator">=</span> <span class="token function">gmssl_sm2_public_key_info_from_pem</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;sm2pub.pem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token variable">$sig</span> <span class="token operator">=</span> <span class="token function">gmssl_sm2_sign</span><span class="token punctuation">(</span><span class="token variable">$sign_key</span><span class="token punctuation">,</span> <span class="token constant">GMSSL_SM2_DEFAULT_ID</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;To be signed message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">gmssl_sm2_verify</span><span class="token punctuation">(</span><span class="token variable">$sm2_pub</span><span class="token punctuation">,</span> <span class="token constant">GMSSL_SM2_DEFAULT_ID</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;To be signed message&quot;</span><span class="token punctuation">,</span> <span class="token variable">$sig</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token variable">$ciphertext</span> <span class="token operator">=</span> <span class="token function">gmssl_sm2_encrypt</span><span class="token punctuation">(</span><span class="token variable">$sm2_pub</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;Secret key materials&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$plaintext</span> <span class="token operator">=</span> <span class="token function">gmssl_sm2_decrypt</span><span class="token punctuation">(</span><span class="token variable">$sm2_key</span><span class="token punctuation">,</span> <span class="token variable">$ciphertext</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token variable">$plaintext</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h2 id="gmssl-php-api"><a href="#gmssl-php-api" class="header-anchor">#</a> GmSSL PHP API</h2> <h3 id="predefined-constants"><a href="#predefined-constants" class="header-anchor">#</a> Predefined Constants</h3> <ul><li><strong>GMSSL_PHP_VERSION</strong>(string)</li> <li><strong>GMSSL_LIBRARAY_VERSION</strong> (string)</li> <li><strong>GMSSL_SM3_DIGEST_SIZE</strong> (int)</li> <li><strong>GMSSL_SM3_HMAC_SIZE</strong> (int)</li> <li><strong>GMSSL_SM3_HMAC_MIN_KEY_SIZE</strong> (int)</li> <li><strong>GMSSL_SM4_KEY_SIZE</strong> (int)</li> <li><strong>GMSSL_SM4_BLOCK_SIZE</strong> (int)</li> <li><strong>GMSSL_SM4_CBC_IV_SIZE</strong> (int)</li> <li><strong>GMSSL_SM4_CTR_IV_SIZE</strong> (int)</li> <li><strong>GMSSL_SM4_GCM_MIN_IV_SIZE</strong> (int)</li> <li><strong>GMSSL_SM4_GCM_MAX_IV_SIZE</strong> (int)</li> <li><strong>GMSSL_SM4_GCM_DEFAULT_IV_SIZE</strong> (int)</li> <li><strong>GMSSL_SM4_GCM_MAX_TAG_SIZE</strong> (int)</li> <li><strong>GMSSL_SM2_DEFAULT_ID</strong> (string)</li> <li><strong>GMSSL_SM2_MAX_PLAINTEXT_SIZE</strong> (int)</li> <li><strong>GMSSL_SM9_MAX_PLAINTEXT_SIZE</strong> (int)</li> <li><strong>GMSSL_ZUC_KEY_SIZE</strong> (int)</li> <li><strong>GMSSL_ZUC_IV_SIZE</strong> (int)</li></ul> <h3 id="functions"><a href="#functions" class="header-anchor">#</a> Functions</h3> <ul><li><a href="#gmssl_rand_bytes">gmssl_rand_bytes</a> - Generate cryptographic secure random bytes</li> <li><a href="#gmssl_sm3">gmssl_sm3</a> - Calculate the SM3 digest of a message</li> <li><a href="#gmssl_sm3_hmac">gmssl_sm3_hmac</a> - Calculate the HMAC-SM3 MAC tag of a message</li> <li><a href="#gmssl_sm3_pbkdf2">gmssl_sm3_pbkdf2</a> - Extract key material from a password by using KBKDF2-HMAC-SM3</li> <li><a href="#gmssl_sm4_encrypt">gmssl_sm4_encrypt</a> - Encrypt a block of message using SM4 cipher.</li> <li><a href="#gmssl_sm4_decrypt">gmssl_sm4_decrypt</a> - Decrypt a block of ciphertext using SM4 cipher.</li> <li><a href="#gmssl_sm4_cbc_encrypt">gmssl_sm4_cbc_encrypt</a> - Encrypt message using SM4-CBC mode (with padding)</li> <li><a href="#gmssl_sm4_cbc_decrypt">gmssl_sm4_cbc_decrypt</a> - Decrypt SM4-CBC (with padding) ciphertext</li> <li><a href="#gmssl_sm4_ctr_encrypt">gmssl_sm4_ctr_encrypt</a> - Encrypt/decrypt message with SM4-CTR mode</li> <li><a href="#gmssl_sm4_gcm_encrypt">gmssl_sm4_gcm_encrypt</a> - Encrypt message using SM4-GCM mode</li> <li><a href="#gmssl_sm4_gcm_decrypt">gmssl_sm4_gcm_decrypt</a> - Decrypt SM4-GCM ciphertext</li> <li><a href="#gmssl_zuc_encrypt">gmssl_zuc_encrypt</a> - Encrypt/decrypt message using ZUC stream cipher</li> <li><a href="#gmssl_sm2_key_generate">gmssl_sm2_key_generate</a> - Generate SM2 Keypair</li> <li><a href="#gmssl_sm2_compute_z">gmssl_sm2_compute_z</a> - Compute SM2 Z value from public key and ID.</li> <li><a href="#gmssl_sm2_private_key_info_encrypt_to_pem">gmssl_sm2_private_key_info_encrypt_to_pem</a> - Export SM2 private key to password encrypted PEM file</li> <li><a href="#gmssl_sm2_private_key_info_decrypt_from_pem">gmssl_sm2_private_key_info_decrypt_from_pem</a> - Import SM2 private key from password encrypted PEM file</li> <li><a href="#gmssl_sm2_public_key_info_to_pem">gmssl_sm2_public_key_info_to_pem</a> - Export SM2 public key to PEM file</li> <li><a href="#gmssl_sm2_public_key_info_from_pem">gmssl_sm2_public_key_info_from_pem</a> - Import SM2 public key from PEM file</li> <li><a href="#gmssl_sm2_sign">gmssl_sm2_sign</a> - Sign message (not digest) and generate SM2 signature</li> <li><a href="#gmssl_sm2_verify">gmssl_sm2_verify</a> - Verify SM2 signature</li> <li><a href="#gmssl_sm2_encrypt">gmssl_sm2_encrypt</a> - Encrypt short secret message with SM2 public key</li> <li><a href="#gmssl_sm2_decrypt">gmssl_sm2_decrypt</a> - Decrypt SM2 ciphertext with SM2 private key</li> <li><a href="#gmssl_sm9_sign_master_key_generate">gmssl_sm9_sign_master_key_generate</a> - Generate SM9 signing master key</li> <li><a href="#gmssl_sm9_sign_master_key_extract_key">gmssl_sm9_sign_master_key_extract_key</a> - Extract the signing private key from SM9 master key with signer's ID</li> <li><a href="#gmssl_sm9_sign_master_key_info_encrypt_to_pem">gmssl_sm9_sign_master_key_info_encrypt_to_pem</a> - Export SM9 signing master key to encrypted PEM file</li> <li><a href="#gmssl_sm9_sign_master_key_info_decrypt_from_pem">gmssl_sm9_sign_master_key_info_decrypt_from_pem</a> - Import SM9 signing master key from encrypted PEM file</li> <li><a href="#gmssl_sm9_sign_master_public_key_to_pem">gmssl_sm9_sign_master_public_key_to_pem</a> - Export SM9 signing master public key to file</li> <li><a href="#gmssl_sm9_sign_master_public_key_from_pem">gmssl_sm9_sign_master_public_key_from_pem</a> - Import SM9 signing master public key from file</li> <li><a href="#gmssl_sm9_sign_key_info_encrypt_to_pem">gmssl_sm9_sign_key_info_encrypt_to_pem</a> - Export user's SM9 signing key to encrypted PEM file</li> <li><a href="#gmssl_sm9_sign_key_info_decrypt_from_pem">gmssl_sm9_sign_key_info_decrypt_from_pem</a> - Import user's SM9 signing key from encrypted PEM file</li> <li><a href="#gmssl_sm9_sign">gmssl_sm9_sign</a> - Sign message with user's SM9 signing key</li> <li><a href="#gmssl_sm9_verify">gmssl_sm9_verify</a> - Verify SM9 signature of message with signer's ID</li> <li><a href="#gmssl_sm9_enc_master_key_generate">gmssl_sm9_enc_master_key_generate</a> - Generate SM9 encryption master key</li> <li><a href="#gmssl_sm9_enc_master_key_extract_key">gmssl_sm9_enc_master_key_extract_key</a> - Extract the encryption private key from SM9 master key with user's ID</li> <li><a href="#gmssl_sm9_enc_master_key_info_encrypt_to_pem">gmssl_sm9_enc_master_key_info_encrypt_to_pem</a> - Export SM9 encryption master key to encrypted PEM file</li> <li><a href="#gmssl_sm9_enc_master_key_info_decrypt_from_pem">gmssl_sm9_enc_master_key_info_decrypt_from_pem</a> - Import SM9 encryption master key from encrypted PEM file</li> <li><a href="#gmssl_sm9_enc_master_public_key_to_pem">gmssl_sm9_enc_master_public_key_to_pem</a> - Export SM9 encryption master public key to file</li> <li><a href="#gmssl_sm9_enc_master_public_key_from_pem">gmssl_sm9_enc_master_public_key_from_pem</a> - Import SM9 encryption master public key from file</li> <li><a href="#gmssl_sm9_enc_key_info_encrypt_to_pem">gmssl_sm9_enc_key_info_encrypt_to_pem</a> - Export user's SM9 encryption key to encrypted PEM file</li> <li><a href="#gmssl_sm9_enc_key_info_decrypt_from_pem">gmssl_sm9_enc_key_info_decrypt_from_pem</a> - Import user's SM9 encryption key from encrypted PEM file</li> <li><a href="#gmssl_sm9_encrypt">gmssl_sm9_encrypt</a> - Encrypt short message with recipient's ID</li> <li><a href="#gmssl_sm9_decrypt">gmssl_sm9_decrypt</a> - Decrypt SM9 ciphertext with user's SM9 private key</li> <li><a href="#gmssl_cert_from_pem">gmssl_cert_from_pem</a> - Import X.509 certificate from PEM file</li> <li><a href="#gmssl_cert_print">gmssl_cert_print</a> - Print details of a X.509 certificate</li> <li><a href="#gmssl_cert_get_serial_number">gmssl_cert_get_serial_number</a> - Get the SerialNumber field of a certificate.</li> <li><a href="#gmssl_cert_get_issuer">gmssl_cert_get_issuer</a> - Get the Issuer field of a certificate</li> <li><a href="#gmssl_cert_get_validity">gmssl_cert_get_validity</a> - Get the Validity field of a certificate</li> <li><a href="#gmssl_cert_get_subject">gmssl_cert_get_subject</a> - Get the Subject field of a certificate</li> <li><a href="#gmssl_cert_get_subject_public_key">gmssl_cert_get_subject_public_key</a> - Get the subject public key of a SM2 certificate.</li> <li><a href="#gmssl_cert_verify_by_ca_cert">gmssl_cert_verify_by_ca_cert</a> - Verify a SM2 certificate by a CA certificate.</li></ul> <h3 id="gmssl-rand-bytes"><a href="#gmssl-rand-bytes" class="header-anchor">#</a> <strong>gmssl_rand_bytes</strong></h3> <p>Generate cryptographic secure random bytes.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_rand_bytes</span><span class="token punctuation">(</span><span class="token keyword type-hint">int</span> <span class="token variable">$length</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>length - Number of bytes of the required random string. Must be a positive integer and should not be too long (such as over 1 MB).</li></ul></li> <li>Return Values - Return a string of generated random binary raw data.</li> <li>Errors/Exceptions - Throws an Exception on failure.</li></ul> <h3 id="gmssl-sm3"><a href="#gmssl-sm3" class="header-anchor">#</a> <strong>gmssl_sm3</strong></h3> <p>Calculate the SM3 digest of a message.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm3</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$message</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>message - String of the to be digested message.</li></ul></li> <li>Return Values - Return a string of the bytes. The length of string should be GMSSL_SM3_DIGEST_SIZE.</li></ul> <h3 id="gmssl-sm3-hmac"><a href="#gmssl-sm3-hmac" class="header-anchor">#</a> <strong>gmssl_sm3_hmac</strong></h3> <p>Calculate the HMAC-SM3 MAC tag of a messag.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm3_hmac</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$message</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>key - a string of the binary raw key. The length should be at least GMSSL_SM3_HMAC_MIN_KEY_SIZE.</li> <li>message - the message to be signed.</li></ul></li> <li>Return Values - return a string of the MAC tag raw data. The length of string should be GMSSL_SM3_HMAC_SIZE.</li> <li>Errors/Exceptions - throws an Exception on failure.</li></ul> <h3 id="gmssl-sm3-pbkdf2"><a href="#gmssl-sm3-pbkdf2" class="header-anchor">#</a> <strong>gmssl_sm3_pbkdf2</strong></h3> <p>Extract key material from a password by using KBKDF2-HMAC-SM3</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm3_pbkdf2</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$password</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$salt</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">int</span> <span class="token variable">$iter</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$outlen</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>password - Password from which the extracted key is generated.</li> <li>salt - Unexpected salt of at least 8 bytes long for binary string, or longer for text string.</li> <li>iter - The number of iterations to slow down brute force attacks. The numbers over 8000 are recommended.</li> <li>outlen - Length of the output key.</li></ul></li> <li>Return Values - Returns raw binary string or NULL on failure.</li> <li>Errors/Exceptions - throws an Exception on failure.</li></ul> <h3 id="gmssl-sm4-encrypt"><a href="#gmssl-sm4-encrypt" class="header-anchor">#</a> <strong>gmssl_sm4_encrypt</strong></h3> <p>Encrypt a block of message (16-bytes) using SM4 block cipher.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm4_encrypt</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$data_block</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>key - The encryption key string. The length should be GMSSL_SM4_KEY_SIZE (16).</li> <li>data_block - To be encrypted message block. The length should be GMSSL_SM4_BLOCK_SIZE (16).</li></ul></li> <li>Return Values - The encrypted ciphertext block with length GMSSL_SM4_BLOCK_SIZE (16).</li> <li>Errors/Exceptions - Throw exceptions on invalid <strong>key</strong> length or <strong>data_block</strong> length.</li></ul> <h3 id="gmssl-sm4-decrypt"><a href="#gmssl-sm4-decrypt" class="header-anchor">#</a> <strong>gmssl_sm4_decrypt</strong></h3> <p>Decrypt a block of message (16-bytes) using SM4 block cipher.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm4_decrypt</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$cipher_block</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>key - The decryption key string. The length should be GMSSL_SM4_KEY_SIZE (16).</li> <li>cipher_block - To be decrypted ciphertext block. The length should be GMSSL_SM4_BLOCK_SIZE (16).</li></ul></li> <li>Return Values - The encrypted ciphertext block with length GMSSL_SM4_BLOCK_SIZE (16).</li> <li>Errors/Exceptions - Throw exceptions on invalid <strong>key</strong> length or <strong>cipher_block</strong> length.</li></ul> <h3 id="gmssl-sm4-cbc-encrypt"><a href="#gmssl-sm4-cbc-encrypt" class="header-anchor">#</a> <strong>gmssl_sm4_cbc_encrypt</strong></h3> <p>Encrypt message using SM4-CBC mode (with padding)</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm4_cbc_encrypt</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$iv</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$data</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>key - The encryption key. The length should be GMSSL_SM4_KEY_SIZE (16).</li> <li>iv - Unpredictable random Initial Vector (IV), length should be GMSSL_SM4_BLOCK_SIZE (16).</li> <li>data - To be encrypted plaintext string of any length.</li></ul></li> <li>Return Values - Raw binary ciphertext, length always be multiple of GMSSL_SM4_BLOCK_SIZE.</li> <li>Errors/Exceptions - Throw exceptions on invalid input or GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm4-cbc-decrypt"><a href="#gmssl-sm4-cbc-decrypt" class="header-anchor">#</a> gmssl_sm4_cbc_decrypt</h3> <p>Decrypt SM4-CBC (with padding) ciphertext</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm4_cbc_decrypt</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$iv</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$ciphertext</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>key - The decryption key. The length should be GMSSL_SM4_KEY_SIZE (16).</li> <li>iv - Initial Vector (IV), length should be GMSSL_SM4_BLOCK_SIZE (16).</li> <li>data - To be decrypted plaintext, length should be multiple of GMSSL_SM4_BLOCK_SIZE.</li></ul></li> <li>Return Values - Decrypted plaintext.</li> <li>Errors/Exceptions - Throw exceptions on invalid input or GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm4-ctr-encrypt"><a href="#gmssl-sm4-ctr-encrypt" class="header-anchor">#</a> gmssl_sm4_ctr_encrypt</h3> <p>Encrypt/decrypt message with SM4-CTR mode.
The encryption and decryption is the same in CTR mode. So there is no <strong>gmssl_sm4_ctr_decrypt</strong>.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm4_ctr_encrypt</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$iv</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$data</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>key - The encryption key. The length should be GMSSL_SM4_KEY_SIZE (16).</li> <li>iv - Unpredictable random Initial Vector (IV), length should be GMSSL_SM4_BLOCK_SIZE (16).</li> <li>data - The plaintext or ciphertext of any length.</li></ul></li> <li>Return Values - Encrypt/decrypt result.</li> <li>Errors/Exceptions - Throw exceptions on invalid input or GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm4-gcm-encrypt"><a href="#gmssl-sm4-gcm-encrypt" class="header-anchor">#</a> <strong>gmssl_sm4_gcm_encrypt</strong></h3> <p>Encrypt message using SM4-GCM mode</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm4_gcm_encrypt</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$iv</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$aad</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">int</span> <span class="token variable">$taglen</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$data</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>key - The encryption key. The length should be GMSSL_SM4_KEY_SIZE (16).</li> <li>iv - Initial Vector (IV), length should be between GMSSL_SM4_GCM_MIN_IV_SIZE and GMSSL_SM4_GCM_MAX_IV_SIZE. Use GMSSL_SM4_GCM_DEFAULT_IV_SIZE is recommened.</li> <li>aad - AAD (Associated Authenticated Data) is the authenticated-only message (not encrypted).</li> <li>taglen - Length of generated MAC tag.</li> <li>data - To be encrypted plaintext of any length.</li></ul></li> <li>Return Values - The output GCM ciphertext.</li> <li>Errors/Exceptions - Throw exceptions on invalid input or GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm4-gcm-decrypt"><a href="#gmssl-sm4-gcm-decrypt" class="header-anchor">#</a> <strong>gmssl_sm4_gcm_decrypt</strong></h3> <p>Decrypt SM4-GCM ciphertext</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm4_gcm_decrypt</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$iv</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$aad</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">int</span> <span class="token variable">$taglen</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$ciphertext</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>key - The decryption key. The length should be GMSSL_SM4_KEY_SIZE (16).</li> <li>iv - Initial Vector (IV), use the same value in gmssl_sm4_gcm_encrypt</li> <li>aad - AAD (Associated Authenticated Data) is the authenticated-only message (not encrypted).</li> <li>taglen - Length of the MAC tag at the last of ciphertext.</li> <li>data - To be encrypted plaintext of any length.</li></ul></li> <li>Return Values - The output GCM ciphertext.</li> <li>Errors/Exceptions - Throw exceptions on invalid input or GmSSL library inner errors.</li></ul> <h3 id="gmssl-zuc-encrypt"><a href="#gmssl-zuc-encrypt" class="header-anchor">#</a> <strong>gmssl_zuc_encrypt</strong></h3> <p>Encrypt/decrypt message using ZUC stream cipher</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_zuc_encrypt</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$iv</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$data</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>key - The encryption key. The length should be GMSSL_ZUC_KEY_SIZE (16).</li> <li>iv - Unpredictable random Initial Vector (IV), length should be GMSSL_ZUC_IV_SIZE (16).</li> <li>data - The plaintext or ciphertext of any length.</li></ul></li> <li>Return Values - Encrypt/decrypt result.</li> <li>Errors/Exceptions - Throw exceptions on invalid input or GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm2-key-generate"><a href="#gmssl-sm2-key-generate" class="header-anchor">#</a> <strong>gmssl_sm2_key_generate</strong></h3> <p>Generate SM2 Keypair</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm2_key_generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters - None</li> <li>Return Values - SM2 private key (the same as SM2 key pair). The return string is 96 bytes. The first 64 bytes are the RAW public key. The last 32 bytes are the raw private key.</li> <li>Errors/Exceptions - Throw exceptions on GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm2-compute-z"><a href="#gmssl-sm2-compute-z" class="header-anchor">#</a> <strong>gmssl_sm2_compute_z</strong></h3> <p>Compute SM2 Z value from SM2 public key and user's identity.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm2_compute_z</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$public_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$id</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>public_key - SM2 public key. Typically SM2 public key is imported by calling <code>gmssl_sm2_public_key_info_from_pem</code>. But SM2 private key is also acceptable for this function.</li> <li>id - User's identity string. If no explicit identity scheme is specified, the default value GMSSL_SM2_DEFAULT_ID should be used.</li></ul></li> <li>Return Values - The output Z value, a string of 32-byte raw data.</li> <li>Errors/Exceptions - Throw exceptions on invalid input or GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm2-private-key-info-encrypt-to-pem"><a href="#gmssl-sm2-private-key-info-encrypt-to-pem" class="header-anchor">#</a> <strong>gmssl_sm2_private_key_info_encrypt_to_pem</strong></h3> <p>Export SM2 private key to password encrypted PEM file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm2_private_key_info_encrypt_to_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$keypair</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$passphrase</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span>
</code></pre></div><ul><li>Parameters
<ul><li>keypair - SM2 private key, should be 96-byte string generated from <code>gmssl_sm2_key_generate</code>.</li> <li>file - The output PEM file path.</li> <li>passphrase - The passphrase/password to encrypt the private key.</li></ul></li> <li>Return Values: <strong>true</strong> on success or <strong>false</strong> on failure.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm2-private-key-info-decrypt-from-pem"><a href="#gmssl-sm2-private-key-info-decrypt-from-pem" class="header-anchor">#</a> <strong>gmssl_sm2_private_key_info_decrypt_from_pem</strong></h3> <p>Import SM2 private key from password encrypted PEM file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm2_private_key_info_decrypt_from_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$passphrase</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>file - The password encrypted SM2 private key PEM file.</li> <li>passphrase - The passphrase/password to decrypt the private key.</li></ul></li> <li>Return Values: SM2 private key, inner format is same as the output of <code>gmssl_sm2_key_generate</code>.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm2-public-key-info-to-pem"><a href="#gmssl-sm2-public-key-info-to-pem" class="header-anchor">#</a> <strong>gmssl_sm2_public_key_info_to_pem</strong></h3> <p>Export SM2 public key to PEM file.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm2_public_key_info_to_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$public_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span>
</code></pre></div><ul><li>Parameters
<ul><li>public_key - The SM2 public key to be exported. SM2 private key as input is also accepted and only the public key will be exported.</li> <li>file - The output PEM file path.</li></ul></li> <li>Return Values: <strong>true</strong> on success or <strong>false</strong> on failure.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm2-public-key-info-from-pem"><a href="#gmssl-sm2-public-key-info-from-pem" class="header-anchor">#</a> <strong>gmssl_sm2_public_key_info_from_pem</strong></h3> <p>Import SM2 public key from PEM file.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm2_public_key_info_from_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>file - The public key PEM file.</li></ul></li> <li>Return Values: SM2 public key, a 96-byte string with the last 32-byte private key all zeros.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm2-sign"><a href="#gmssl-sm2-sign" class="header-anchor">#</a> <strong>gmssl_sm2_sign</strong></h3> <p>Sign message (not digest) and generate SM2 signature</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm2_sign</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$keypair</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$id</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$message</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>keypair - Signer's SM2 private key, typically from <code>gmssl_sm2_key_generate</code>.</li> <li>id - Signer's identity string. If no explicit identity scheme is specified, the default value GMSSL_SM2_DEFAULT_ID should be used.</li> <li>messsage - To be signed message of any length.</li></ul></li> <li>Return Values - The generated SM2 signature in DER encoding, the raw data bytes start with a <code>0x30</code> and the typical signature length is 70, 71 or 72 bytes.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm2-verify"><a href="#gmssl-sm2-verify" class="header-anchor">#</a> <strong>gmssl_sm2_verify</strong></h3> <p><code>gmssl_sm2_verify</code> - Verify SM2 signature</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm2_verify</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$public_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$id</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$message</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$signature</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span>
</code></pre></div><ul><li>Parameters
<ul><li>public_key - Signer's SM2 public key, typically from <code>gmssl_sm2_public_key_info_from_pem</code> or <code>gmssl_cert_get_subject_public_key</code>.</li> <li>id - Signer's identity string. If no explicit identity scheme is specified, the default value GMSSL_SM2_DEFAULT_ID should be used.</li> <li>messsage - The signed message.</li> <li>signature - The SM2 signature in DER-encoding.</li></ul></li> <li>Return Values - <strong>ture</strong> or <strong>false</strong>.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm2-encrypt"><a href="#gmssl-sm2-encrypt" class="header-anchor">#</a> <strong>gmssl_sm2_encrypt</strong></h3> <p>Encrypt short secret message with SM2 public key.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm2_encrypt</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$public_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$data</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>public_key - Receiver's SM2 public key, typically from <code>gmssl_sm2_public_key_info_from_pem</code> or <code>gmssl_cert_get_subject_public_key</code>.</li> <li>data - To be encrypted plaintext. SM2 encryption should be used to protect key materials. The length should not longer than GMSSL_SM2_MAX_PLAINTEXT_SIZE.</li></ul></li> <li>Return Values - Ciphertext.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm2-decrypt"><a href="#gmssl-sm2-decrypt" class="header-anchor">#</a> <strong>gmssl_sm2_decrypt</strong></h3> <p>Decrypt SM2 ciphertext with SM2 private key</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm2_decrypt</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$keypair</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$ciphertext</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>keypair - Receiver's SM2 private key</li> <li>data - Ciphertext.</li></ul></li> <li>Return Values - Plaintext.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-sign-master-key-generate"><a href="#gmssl-sm9-sign-master-key-generate" class="header-anchor">#</a> <strong>gmssl_sm9_sign_master_key_generate</strong></h3> <p>Generate SM9 signing master key</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_sign_master_key_generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters - None</li> <li>Return Values - SM9 signing master key.</li> <li>Errors/Exceptions - Throw exceptions on GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-sign-master-key-extract-key"><a href="#gmssl-sm9-sign-master-key-extract-key" class="header-anchor">#</a> <strong>gmssl_sm9_sign_master_key_extract_key</strong></h3> <p>Extract the signing private key from SM9 master key with signer's ID</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_sign_master_key_extract_key</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$master_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$id</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>master_key - SM9 signing master key.</li> <li>id - User's identity</li></ul></li> <li>Return Values - User's sm9 signing private key extracted from the master key correponding to the given <strong>id</strong></li> <li>Errors/Exceptions - Throw exceptions on invalid parameters or GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-sign-master-key-info-encrypt-to-pem"><a href="#gmssl-sm9-sign-master-key-info-encrypt-to-pem" class="header-anchor">#</a> <strong>gmssl_sm9_sign_master_key_info_encrypt_to_pem</strong></h3> <p>Export SM9 signing master key to encrypted PEM file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_sign_master_key_info_encrypt_to_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$master_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$passphrase</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span>
</code></pre></div><ul><li>Parameters
<ul><li>master_key - SM9 signing master key</li> <li>file - The output PEM file path.</li> <li>passphrase - The passphrase/password to encrypt the private key.</li></ul></li> <li>Return Values: <strong>true</strong> on success or <strong>false</strong> on failure.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-sign-master-key-info-decrypt-from-pem"><a href="#gmssl-sm9-sign-master-key-info-decrypt-from-pem" class="header-anchor">#</a> <strong>gmssl_sm9_sign_master_key_info_decrypt_from_pem</strong></h3> <p>Import SM9 signing master key from encrypted PEM file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_sign_master_key_info_decrypt_from_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$passphrase</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>file - The input password encrypted SM9 signing master key PEM file path.</li> <li>passphrase - The passphrase/password to decrypt the PEM file.</li></ul></li> <li>Return Values: SM9 signing master key</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-sign-master-public-key-to-pem"><a href="#gmssl-sm9-sign-master-public-key-to-pem" class="header-anchor">#</a> <strong>gmssl_sm9_sign_master_public_key_to_pem</strong></h3> <p>Export SM9 signing master public key to file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_sign_master_public_key_to_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$master_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span>
</code></pre></div><ul><li>Parameters
<ul><li>master_key - SM9 signing master key or master public key</li> <li>file - The output SM9 signing master public key PEM file path.</li></ul></li> <li>Return Values: <strong>true</strong> on success or <strong>false</strong> on failure.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-sign-master-public-key-from-pem"><a href="#gmssl-sm9-sign-master-public-key-from-pem" class="header-anchor">#</a> <strong>gmssl_sm9_sign_master_public_key_from_pem</strong></h3> <p>Import SM9 signing master public key from file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_sign_master_public_key_from_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>file - The SM9 signing master public key PEM file.</li></ul></li> <li>Return Values: SM9 signing master public key.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-sign-key-info-encrypt-to-pem"><a href="#gmssl-sm9-sign-key-info-encrypt-to-pem" class="header-anchor">#</a> <strong>gmssl_sm9_sign_key_info_encrypt_to_pem</strong></h3> <p>Export user's SM9 signing key to encrypted PEM file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_sign_key_info_encrypt_to_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$sign_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$passphrase</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span>
</code></pre></div><ul><li>Parameters
<ul><li>sign_key - SM9 signing private key</li> <li>file - The output PEM file path.</li> <li>passphrase - The passphrase/password to encrypt the private key.</li></ul></li> <li>Return Values: <strong>true</strong> on success or <strong>false</strong> on failure.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-sign-key-info-decrypt-from-pem"><a href="#gmssl-sm9-sign-key-info-decrypt-from-pem" class="header-anchor">#</a> <strong>gmssl_sm9_sign_key_info_decrypt_from_pem</strong></h3> <p>Import user's SM9 signing key from encrypted PEM file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_sign_key_info_decrypt_from_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$passphrase</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>file - The input password encrypted SM9 signing private key PEM file path.</li> <li>passphrase - The passphrase/password to decrypt the PEM file.</li></ul></li> <li>Return Values: SM9 signing private key</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-sign"><a href="#gmssl-sm9-sign" class="header-anchor">#</a> <strong>gmssl_sm9_sign</strong></h3> <p>Sign message with user's SM9 signing key</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_sign</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$sign_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$message</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>sign_key - Signer's SM9 private key.</li> <li>messsage - To be signed message of any length.</li></ul></li> <li>Return Values - The generated SM9 signature in DER encoding, the raw data bytes start with a <code>0x30</code> byte.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-verify"><a href="#gmssl-sm9-verify" class="header-anchor">#</a> <strong>gmssl_sm9_verify</strong></h3> <p>Verify SM9 signature of message with signer's ID</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_verify</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$master_public_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$id</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$message</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$signature</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span>
</code></pre></div><ul><li>Parameters
<ul><li>master_public_key - SM9 signing master public key.</li> <li>id - Signer's identity string.</li> <li>messsage - Signed message of any length.</li> <li>signature - SM9 signature.</li></ul></li> <li>Return Values - <strong>ture</strong> or <strong>false</strong>.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-enc-master-key-generate"><a href="#gmssl-sm9-enc-master-key-generate" class="header-anchor">#</a> <strong>gmssl_sm9_enc_master_key_generate</strong></h3> <p>Generate SM9 encryption master key</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_enc_master_key_generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters - None</li> <li>Return Values - SM9 signing master key.</li> <li>Errors/Exceptions - Throw exceptions on GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-enc-master-key-extract-key"><a href="#gmssl-sm9-enc-master-key-extract-key" class="header-anchor">#</a> <strong>gmssl_sm9_enc_master_key_extract_key</strong></h3> <p>Extract the encryption private key from SM9 master key with user's ID</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_enc_master_key_extract_key</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$master_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$id</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>master_key - SM9 encryption master key.</li> <li>id - User's identity</li></ul></li> <li>Return Values - User's sm9 encryption private key extracted from the master key correponding to the given <strong>id</strong></li> <li>Errors/Exceptions - Throw exceptions on invalid parameters or GmSSL library inner errors.</li></ul> <p>###<strong>gmssl_sm9_enc_master_key_info_encrypt_to_pem</strong></p> <p>Export SM9 encryption master key to encrypted PEM file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_enc_master_key_info_encrypt_to_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$master_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$passphrase</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span>
</code></pre></div><ul><li>Parameters
<ul><li>master_key - SM9 encryption master key</li> <li>file - The output PEM file path.</li> <li>passphrase - The passphrase/password to encrypt the private key.</li></ul></li> <li>Return Values: <strong>true</strong> on success or <strong>false</strong> on failure.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-enc-master-key-info-decrypt-from-pem"><a href="#gmssl-sm9-enc-master-key-info-decrypt-from-pem" class="header-anchor">#</a> <strong>gmssl_sm9_enc_master_key_info_decrypt_from_pem</strong></h3> <p>Import SM9 encryption master key from encrypted PEM file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_enc_master_key_info_decrypt_from_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$passphrase</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>file - The input password encrypted SM9 encryption master key PEM file path.</li> <li>passphrase - The passphrase/password to decrypt the PEM file.</li></ul></li> <li>Return Values: SM9 encryption master key</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-enc-master-public-key-to-pem"><a href="#gmssl-sm9-enc-master-public-key-to-pem" class="header-anchor">#</a> <strong>gmssl_sm9_enc_master_public_key_to_pem</strong></h3> <p>Export SM9 encryption master public key to file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_enc_master_public_key_to_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$master_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span>
</code></pre></div><ul><li>Parameters
<ul><li>master_key - SM9 encryption master key or master public key</li> <li>file - The output SM9 encryption master public key PEM file path.</li></ul></li> <li>Return Values: <strong>true</strong> on success or <strong>false</strong> on failure.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-enc-master-public-key-from-pem"><a href="#gmssl-sm9-enc-master-public-key-from-pem" class="header-anchor">#</a> <strong>gmssl_sm9_enc_master_public_key_from_pem</strong></h3> <p>Import SM9 encryption master public key from file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_enc_master_public_key_from_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>file - The SM9 encryption master public key PEM file.</li></ul></li> <li>Return Values: SM9 encryption master public key.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-enc-key-info-encrypt-to-pem"><a href="#gmssl-sm9-enc-key-info-encrypt-to-pem" class="header-anchor">#</a> <strong>gmssl_sm9_enc_key_info_encrypt_to_pem</strong></h3> <p>Export user's SM9 encryption key to encrypted PEM file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_enc_key_info_encrypt_to_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$enc_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$passphrase</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span>
</code></pre></div><ul><li>Parameters
<ul><li>enc_key - SM9 encryption private key</li> <li>file - The output PEM file path.</li> <li>passphrase - The passphrase/password to encrypt the private key.</li></ul></li> <li>Return Values: <strong>true</strong> on success or <strong>false</strong> on failure.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-enc-key-info-decrypt-from-pem"><a href="#gmssl-sm9-enc-key-info-decrypt-from-pem" class="header-anchor">#</a> <strong>gmssl_sm9_enc_key_info_decrypt_from_pem</strong></h3> <p>Import user's SM9 encryption key from encrypted PEM file</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_enc_key_info_decrypt_from_pem</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$file</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$passphrase</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>file - The input password encrypted SM9 encryption private key PEM file path.</li> <li>passphrase - The passphrase/password to decrypt the PEM file.</li></ul></li> <li>Return Values: SM9 encryption private key</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-encrypt"><a href="#gmssl-sm9-encrypt" class="header-anchor">#</a> <strong>gmssl_sm9_encrypt</strong></h3> <p>Encrypt short message with recipient's ID</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_encrypt</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$master_public_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$id</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$data</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>master_public_key - SM9 encryption master public key.</li> <li>data - To be encrypted plaintext. SM9 encryption should be used to protect key materials. The length should not longer than GMSSL_SM9_MAX_PLAINTEXT_SIZE.</li></ul></li> <li>Return Values - Ciphertext.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-sm9-decrypt"><a href="#gmssl-sm9-decrypt" class="header-anchor">#</a> <strong>gmssl_sm9_decrypt</strong></h3> <p>Decrypt SM9 ciphertext with user's SM9 private key</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_sm9_decrypt</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$enc_key</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$id</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$ciphertext</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>enc_key - Receiver's SM9 encryption/decryption private key</li> <li>id - Receiver's identity</li> <li>ciphertext - SM9 Ciphertext.</li></ul></li> <li>Return Values - Plaintext.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-cert-from-pem"><a href="#gmssl-cert-from-pem" class="header-anchor">#</a> <strong>gmssl_cert_from_pem</strong></h3> <p>Import X.509 certificate from PEM file.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_cert_from_pem</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>path - Certificate file path, the certificate should be a SM2 certficate in PEM format.</li></ul></li> <li>Return Values - SM2 certificate. The raw data of the return value is the DER-encoding bytes of the certificate.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-cert-print"><a href="#gmssl-cert-print" class="header-anchor">#</a> <strong>gmssl_cert_print</strong></h3> <p>Print details of a X.509 certificate.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_cert_print</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$cert</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$label</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span>
</code></pre></div><ul><li>Parameters
<ul><li>cert - SM2 certificate, typically from <code>gmssl_cert_from_pem</code>.</li> <li>label - Label string that will be printed at the first line of the output.</li></ul></li> <li>Return Values - <strong>true</strong> or <strong>false</strong></li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-cert-get-serial-number"><a href="#gmssl-cert-get-serial-number" class="header-anchor">#</a> <strong>gmssl_cert_get_serial_number</strong></h3> <p>Get the SerialNumber field of a X.509 certificate.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_cert_get_serial_number</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$cert</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>cert - SM2 certificate, typically from <code>gmssl_cert_from_pem</code>.</li></ul></li> <li>Return Values - SerialNumber field raw data (bytes).</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-cert-get-issuer"><a href="#gmssl-cert-get-issuer" class="header-anchor">#</a> <strong>gmssl_cert_get_issuer</strong></h3> <p>Get the Issuer field of a X.509 certificate.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_cert_get_issuer</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$cert</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">array</span>
</code></pre></div><ul><li>Parameters
<ul><li>cert - SM2 certificate, typically from <code>gmssl_cert_from_pem</code>.</li></ul></li> <li>Return Values - Issuer field as an array. The element with key <code>raw_data</code> is the DER-encoding of the X.509 DN value (without Tag and Length).</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-cert-get-validity"><a href="#gmssl-cert-get-validity" class="header-anchor">#</a> <strong>gmssl_cert_get_validity</strong></h3> <p>Get the Validity field of a X.509 certificate.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_cert_get_validity</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$cert</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">array</span>
</code></pre></div><ul><li>Parameters
<ul><li>cert - SM2 certificate, typically from <code>gmssl_cert_from_pem</code>.</li></ul></li> <li>Return Values - Validity field of the certificate as an array. The return array has two elements with key <code>notBefore</code> and <code>notAfter</code>, the value is an <code>int</code> value of the timestamp.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-cert-get-subject"><a href="#gmssl-cert-get-subject" class="header-anchor">#</a> <strong>gmssl_cert_get_subject</strong></h3> <p>Get the Subject field of a X.509 certificate.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_cert_get_subject</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$cert</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">array</span>
</code></pre></div><ul><li>Parameters
<ul><li>cert - SM2 certificate, typically from <code>gmssl_cert_from_pem</code>.</li></ul></li> <li>Return Values - Subject field as an array. The element with key <code>raw_data</code> is the DER-encoding of the X.509 DN value (without Tag and Length).</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-cert-get-subject-public-key"><a href="#gmssl-cert-get-subject-public-key" class="header-anchor">#</a> <strong>gmssl_cert_get_subject_public_key</strong></h3> <p>Get the SM2 public key from the SubjectPublicKeyInfo field of a X.509 certificate.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_cert_get_subject_public_key</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$cert</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
</code></pre></div><ul><li>Parameters
<ul><li>cert - SM2 certificate, typically from <code>gmssl_cert_from_pem</code>.</li></ul></li> <li>Return Values - SM2 public key from the SubjectPublicKeyInfo field of the certificate. The return value format is the same as output of the <code>sm2_public_key_info_from_pem</code>.</li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <h3 id="gmssl-cert-verify-by-ca-cert"><a href="#gmssl-cert-verify-by-ca-cert" class="header-anchor">#</a> <strong>gmssl_cert_verify_by_ca_cert</strong></h3> <p>Verify a X.509 certificate by a CA certificate.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">gmssl_cert_verify_by_ca_cert</span><span class="token punctuation">(</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$cert</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$cacert</span><span class="token punctuation">,</span>
	<span class="token keyword type-hint">string</span> <span class="token variable">$sm2_id</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span>
</code></pre></div><ul><li>Parameters
<ul><li>cert - The verified SM2 certificate, to be verified if it is signed (issued) by the <strong>cacert</strong>.</li> <li>cacert - The CA's SM2 certificate. The Issuer field of <strong>cert</strong> should be the same as the Subject field of the <strong>cacert</strong>.</li> <li>sm2_id - The CA's signing SM2 ID, is not specified, GMSSL_SM2_DEFAULT_ID should be used.</li></ul></li> <li>Return Values - <strong>true</strong> or <strong>false</strong></li> <li>Errors/Exceptions - Throw exceptions on invalid parameters and GmSSL library inner errors.</li></ul> <p>同步时间: 2025-07-12 03:19:44</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/gmssl-docs2.0/multilanguage/python.html" class="prev">
        GmSSL-Python
      </a></span> <span class="next"><a href="/gmssl-docs2.0/multilanguage/go.html">
        GmSSL-Go
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/gmssl-docs2.0/assets/js/app.1d85ac51.js" defer></script><script src="/gmssl-docs2.0/assets/js/2.a98f6d9f.js" defer></script><script src="/gmssl-docs2.0/assets/js/1.43cfabac.js" defer></script><script src="/gmssl-docs2.0/assets/js/36.d1e4ac7a.js" defer></script>
  </body>
</html>
